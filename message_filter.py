class MessageFilter:
    def __init__(self):
        # –°–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º
        self.ignored_messages = [
            "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–∏–¥–µ–æ üëá",
            "üé¨ –í–∏–¥–µ–æ –±—É–¥—É—â–µ–≥–æ",
            "‚ö†Ô∏è –ù–µ –≤—ã–±—Ä–∞–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —á–∞—Ç-–±–æ—Ç–æ–º",
            "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π",
            "–ú–µ–Ω—é",
            "üîî –ü–æ –≤–∞—à–µ–π —Å—Å—ã–ª–∫–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è –Ω–æ–≤—ã–π —Ä–µ—Ñ–µ—Ä–∞–ª.",
            "–ü—Ä–æ—Ñ–∏–ª—å",
            "‚òùÔ∏è –ß—Ç–æ–±—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω—É–∂–Ω–æ –±—ã—Ç—å",
            "–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π",
            "–í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é",
            "–ù–∞–∑–∞–¥",
            "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–∏",
            "–ö—É–±–∏–∫ —É–¥–∞—á–∏",
            "–í—Å—Ç—Ä—è—Ö–Ω–µ–º –µ–≥–æ —Ö–æ—Ä–æ—à–µ–Ω—å–∫–æ",
            "–ü—É—Å—Ç—å –≥—Ä–∞–Ω–∏ –∫—É–±–∏–∫–∞",
            "–∏–≥—Ä–∞–µ–º –≤ –∫—É–±–∏–∫"
        ]
        
        # –°–ø–∏—Å–æ–∫ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã—Ö –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
        self.ignored_edited_messages = [
            "‚è≥ –û–∂–∏–¥–∞–π—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è",
            "‚ö° –ó–∞–¥–∞—á–∞ –æ–∂–∏–¥–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è",
            "–ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ–º–Ω–æ–≥–æ",
            "–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–∂–∏–¥–∞–Ω–∏–µ",
            "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ",
            "‚è≥ –û–¥–Ω—É —Å–µ–∫—É–Ω–¥—É",
            "‚úçÔ∏è –£–∂–µ —Ä–∏—Å—É—é...",
            "‚úçÔ∏è –ó–∞–¥–∞—á–∞ –æ–∂–∏–¥–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.",
            "[82%]üßë‚Äçüé® –ö—Ä—É—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è! C–∫–æ—Ä–æ –∑–∞–∫–æ–Ω—á—É..."
        ]
        
        # –°–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
        self.progress_messages = [
            "‚è≥ –û–∂–∏–¥–∞–π—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è",
            "‚ö° –ó–∞–¥–∞—á–∞ –æ–∂–∏–¥–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è",
            "üé¨ –ì–µ–Ω–µ—Ä–∏—Ä—É—é –≤–∏–¥–µ–æ",
            "‚è≥ –û–¥–Ω—É —Å–µ–∫—É–Ω–¥—É",
            "–ñ–¥–∏—Ç–µ —Å–µ–∫—É–Ω–¥—É"
        ]

        # –°–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Ç–æ—á–Ω–æ —Ö–æ—Ç–∏–º –≤–∏–¥–µ—Ç—å
        self.important_messages = [
            "üìç –ó–∞–ø—Ä–æ—Å:",
            "üìç –í–∞—à –∑–∞–ø—Ä–æ—Å:",
            "–í–∏–¥–µ–æ –≥–æ—Ç–æ–≤–æ",
            "–ì–µ–Ω–µ—Ä–∏—Ä—É—é –≤–∏–¥–µ–æ"
        ]
        
        # –®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö
        self.error_patterns = [
            "–ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞",
            "–æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ",
            "–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å",
            "–Ω–µ —É–¥–∞–ª–æ—Å—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å",
            "–æ—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏",
            "error",
            "failed",
            "–≤–æ–∑–Ω–∏–∫–ª–∞ –ø—Ä–æ–±–ª–µ–º–∞",
            "–Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å"
        ]

    def should_print_message(self, message_text, has_video=False):
        # –í—Å–µ–≥–¥–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è —Å –≤–∏–¥–µ–æ
        if has_video:
            return True
            
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—É—Å—Ç—ã–º
        if not message_text:
            return False

        # –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∞–∂–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
        if any(important in message_text for important in self.important_messages):
            return True
            
        # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã—Ö
        if any(ignored in message_text for ignored in self.ignored_messages):
            return False
            
        # –î–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ –≤—ã–≤–æ–¥–∏–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–æ–µ
        if any(progress in message_text for progress in self.progress_messages):
            return True
            
        # –í—Å–µ–≥–¥–∞ –≤—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
        if any(error_pattern in message_text.lower() for error_pattern in self.error_patterns):
            return True
            
        # –í—ã–≤–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –≤–∏–¥–µ–æ
        if any(param in message_text.lower() for param in ["–∫–∞—á–µ—Å—Ç–≤–æ:", "—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ:", "–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:", "–º–æ–¥–µ–ª—å:"]):
            return True
            
        return False  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ –≤—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ

    def should_process_edited_message(self, message_text, has_video=False):
        """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –Ω—É–∂–Ω–æ –ª–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        
        Args:
            message_text: –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
            has_video: –§–ª–∞–≥ –Ω–∞–ª–∏—á–∏—è –≤–∏–¥–µ–æ
            
        Returns:
            bool: True, –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å
        """
        # –í—Å–µ–≥–¥–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è —Å –≤–∏–¥–µ–æ
        if has_video:
            return True
            
        # –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—É—Å—Ç–æ–µ - –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º
        if not message_text:
            return False
            
        # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã—Ö –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
        if any(ignored in message_text for ignored in self.ignored_edited_messages):
            return False
            
        # –í—Å–µ–≥–¥–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–∞–∂–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
        if any(important in message_text for important in self.important_messages):
            return True
            
        # –í—Å–µ–≥–¥–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è —Å –æ—à–∏–±–∫–∞–º–∏
        if any(error_pattern in message_text.lower() for error_pattern in self.error_patterns):
            return True
            
        return True  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

    def format_message(self, message_text, has_video=False):
        # –ï—Å–ª–∏ –µ—Å—Ç—å –≤–∏–¥–µ–æ, –≤—ã–≤–æ–¥–∏–º –ø–æ–ª–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        if has_video:
            return f"–ü–æ–ª—É—á–µ–Ω–æ –≤–∏–¥–µ–æ: {message_text}"
            
        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
        if any(progress in message_text for progress in self.progress_messages):
            return "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ..."
            
        return message_text 